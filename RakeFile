require 'rubygems'
require 'cucumber'
require 'cucumber/rake/task'


namespace :test do
  def options_for(env_name, pages="default", data_suite="default")
    config_file = env_name || "default"

    "FIG_NEWTON_FILE=#{config_file}.yml pages=#{pages} data_suite=#{data_suite}"
  end

  Cucumber::Rake::Task.new(:functional) do |t|
    t.profile = "functional"
    t.cucumber_opts = options_for(ENV["env"])
  end

  Cucumber::Rake::Task.new(:integration) do |t|
    t.profile = "integration"
    t.cucumber_opts = options_for(ENV["env"])
  end

  Cucumber::Rake::Task.new(:tag) do |t|
    t.profile = "tags"
    t.cucumber_opts = "#{options_for(ENV["env"])} --tags #{ENV["tags"]}"
  end

  task :all => ["test:integration", :"test:functional"]
end

task(:default => "test:all")

